<div class="index_container">
    <div class="map_title">
        <%= image_tag("mapa.svg", :alt => "") %>
    </div>
    <div class="menu menu_homepage">
      <div class="menu_burguer" onclick="myFunction(this)">
        <div class="line one"></div>
        <div class="line two"></div>
        <div class="line tres"></div>
      </div>
      <div class="open_menu">
          <a><%= link_to 'uc de queixas', root_path %></a>
          <a><%= link_to 'lista de problemas', 'listaproblemas' %></a>
          <a><%= link_to 'mapa', map_path %></a>
          <a><%= link_to 'estatísticas', root_path %></a>
          <a><%= link_to 'intervenções', root_path %></a>
          <a><%= link_to 'sobre', about_path %></a>
          <% if user_signed_in? %>
            <%= link_to('sair', destroy_user_session_path, method: :delete) %>
          <% else %>
            <a><%= link_to 'entrar', new_user_session_path %></a>
            <a><%= link_to 'registrar', new_user_registration_path %></a>
          <% end %>
      </div>
    </div>
    <div class="blank_space"></div>
    <div class="map_container">
      <div id='map' style='width: 100%; height: 100%;'></div>
    </div>
    <div class="about_foot" style="text-transform:Uppercase;">
        <%= image_tag("ucqueixa.svg", :alt => "") %>
    </div>
</div>
<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZmVuZ2xpIiwiYSI6ImNqbmtmZjMzcTB3dW8zcHRkeWtvdmsycjUifQ.NmkWCryb7-p2T8v-PZz5ig';
  var map = new mapboxgl.Map({
    center: [-8.416358, 40.185995],
    zoom: 17,
    pitch: 45,
    container: 'map',
    style: 'mapbox://styles/fengli/cjooe36i84bg12sl8uwni61xf'
  });
  map.on('load', function() {
    // Insert the layer beneath any symbol layer.
    var layers = map.getStyle().layers;

    var labelLayerId;
    for (var i = 0; i < layers.length; i++) {
        if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
            labelLayerId = layers[i].id;
            break;
        }
    }

    map.addLayer({
        'id': '3d-buildings',
        'source': 'composite',
        'source-layer': 'building',
        'filter': ['==', 'extrude', 'true'],
        'type': 'fill-extrusion',
        'minzoom': 15,
        'paint': {
            'fill-extrusion-color': '#2b2b2b',

            // use an 'interpolate' expression to add a smooth transition effect to the
            // buildings as the user zooms in
            'fill-extrusion-height': [
                "interpolate", ["linear"], ["zoom"],
                15, 0,
                15.05, ["get", "height"]
            ],
            'fill-extrusion-base': [
                "interpolate", ["linear"], ["zoom"],
                15, 0,
                15.05, ["get", "min_height"]
            ],
            'fill-extrusion-opacity': .6
        }
    }, labelLayerId);
});
</script>